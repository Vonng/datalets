-------------------------------------------------------------------------
-- 人口年鉴数据
-------------------------------------------------------------------------
DROP TABLE IF EXISTS stats.monetary CASCADE;
CREATE TABLE stats.monetary
(
    time DATE PRIMARY KEY, -- 统计月份,
    m0   NUMERIC,          -- 流通中的现金(M0)
    m1   NUMERIC,          -- 货币(M1)
    m2   NUMERIC           -- 货币和准货币(M2)
);
COMMENT ON TABLE stats.monetary IS '中国 货币供应量数据';
COMMENT ON COLUMN stats.monetary.time IS '统计月份';
COMMENT ON COLUMN stats.monetary.m0 IS '流通中的现金(M0)';
COMMENT ON COLUMN stats.monetary.m1 IS '货币(M1)';
COMMENT ON COLUMN stats.monetary.m2 IS '货币和准货币(M2)';

DROP VIEW IF EXISTS stats.monetary_full;
CREATE VIEW stats.monetary_full AS
    SELECT cur.time,
           cur.m0 ::NUMERIC(10, 2)                            as m0,
           cur.m0 - mom.m0 ::NUMERIC(10, 2)                   as m0_mdelta,
           (100 * (cur.m0 - mom.m0) / mom.m0)::NUMERIC(10, 2) AS m0_mom,
           cur.m0 - yoy.m0 ::NUMERIC(10, 2)                   as m0_ydelta,
           (100 * (cur.m0 - yoy.m0) / yoy.m0)::NUMERIC(10, 2) AS m0_yoy,
           cur.m1 ::NUMERIC(10, 2)                            as m1,
           cur.m1 - mom.m1 ::NUMERIC(10, 2)                   as m1_mdelta,
           (100 * (cur.m1 - mom.m1) / mom.m1)::NUMERIC(10, 2) AS m1_mom,
           cur.m1 - yoy.m1 ::NUMERIC(10, 2)                   as m1_ydelta,
           (100 * (cur.m1 - yoy.m1) / yoy.m1)::NUMERIC(10, 2) AS m1_yoy,
           cur.m2::NUMERIC(10, 2)                             as m2,
           cur.m2 - mom.m2 ::NUMERIC(10, 2)                   as m2_mdelta,
           (100 * (cur.m2 - mom.m2) / mom.m2)::NUMERIC(10, 2) AS m2_mom,
           cur.m2 - yoy.m2 ::NUMERIC(10, 2)                   as m2_ydelta,
           (100 * (cur.m2 - yoy.m2) / yoy.m2)::NUMERIC(10, 2) AS m2_yoy
    FROM stats.monetary cur
             LEFT JOIN stats.monetary yoy ON cur.time = yoy.time + '1year'::INTERVAL
             LEFT JOIN stats.monetary mom ON cur.time = mom.time + '1month'::INTERVAL
    ORDER BY 1;

TRUNCATE stats.monetary;
INSERT INTO stats.monetary VALUES
('1952-12-01', 27.5, 92.7, 101.3),
('1953-12-01', 39.4, 101.4, 113.7),
('1954-12-01', 41.2, 116.5, 132.4),
('1955-12-01', 40.3, 126, 145.9),
('1956-12-01', 57.3, 148.3, 175),
('1957-12-01', 52.8, 162.5, 197.7),
('1958-12-01', 67.8, 258, 313.2),
('1959-12-01', 75.1, 323.4, 391.7),
('1960-12-01', 95.9, 342.8, 409.1),
('1961-12-01', 125.7, 384.4, 439.8),
('1962-12-01', 106.5, 395.1, 436.2),
('1963-12-01', 89.9, 390.9, 436.6),
('1964-12-01', 80, 379.2, 434.7),
('1965-12-01', 90.8, 432.4, 497.6),
('1966-12-01', 108.5, 494, 566.3),
('1967-12-01', 121.9, 555.8, 629.7),
('1968-12-01', 134.1, 258.6, 666.9),
('1969-12-01', 137.1, 583.3, 659.2),
('1970-12-01', 123.6, 571.6, 651.1),
('1971-12-01', 136.2, 624.6, 714.9),
('1972-12-01', 151.2, 649.7, 754.9),
('1973-12-01', 166.1, 749.1, 870.3),
('1974-12-01', 176.6, 800.3, 936.8),
('1975-12-01', 182.6, 867.9, 1017.5),
('1976-12-01', 204.6, 925.5, 1084.6),
('1977-12-01', 195.4, 925.7, 1107.3),
('1978-12-01', 212, 948.4, 1159.1),
('1979-12-01', 267.7, 1210.9, 1458.1),
('1980-12-01', 346.2, 1521.3, 1842.9),
('1981-12-01', 396.34, 1755.8, 2234.5),
('1982-12-01', 439.12, 2022.3, 2589.8),
('1983-12-01', 529.78, 2336.4, 3075),
('1984-12-01', 792.08, 3173.1, 4146.3),
('1985-12-01', 987.78, 3528.7, 5198.9),
('1986-12-01', 1218.38, 4415.2, 6718.1),
('1987-12-01', 1454.48, 5291.4, 8252.8),
('1988-12-01', 2133.98, 5985.9, 10099.6),
('1989-12-01', 2343.98, 6382.2, 11949.6),
('1990-12-01', 2644.4, 6950.7, 15293.4),
('1991-12-01', 3177.8, 8633.3, 19349.9),
('1992-12-01', 4336, 11731.5, 25402.2),
('1993-12-01', 5864.7, 16280.4, 34879.8),
('1994-12-01', 7288.6, 20540.7, 46923.5),
('1995-12-01', 7885.3, 23987.1, 60750.5),
('1996-12-01', 8802, 28514.8, 76094.9),
('1997-12-01', 10177.6, 34826.3, 90995.3),
('1998-12-01', 11204.2, 38953.7, 104498.5),
('1999-12-01', 13455.5, 45837.2, 119897.9),
('2000-12-01', 14652.7, 53147.2, 134610.3),
('2001-12-01', 15688.8, 59871.6, 158301.9),
('2002-12-01', 17278, 70881.8, 185007),
('2003-12-01', 19746, 84118.6, 221222.8),
('2004-12-01', 21468.3, 95969.7, 254107),
('2005-01-01', 24015.41, 97079.03, 257708.47),
('2005-02-01', 22667.97, 92814.95, 259357.29),
('2005-03-01', 21238.95, 94743.19, 264588.94),
('2005-04-01', 21666.56, 94593.72, 266992.66),
('2005-05-01', 20811.59, 95802.01, 269240.49),
('2005-06-01', 20848.76, 98601.25, 275785.53),
('2005-07-01', 21171.2, 97674.1, 276966.28),
('2005-08-01', 21351.56, 99377.7, 281288.22),
('2005-09-01', 22272.92, 100964, 287438.27),
('2005-10-01', 21982.98, 101751.98, 287591.61),
('2005-11-01', 22409.39, 104125.78, 292350.39),
('2005-12-01', 24031.67, 107278.57, 298755.48),
('2006-01-01', 29310.37, 107250.68, 303571.65),
('2006-02-01', 24482.02, 104357.08, 304516.27),
('2006-03-01', 23472.03, 106737.08, 310490.65),
('2006-04-01', 24155.73, 106389.11, 313702.34),
('2006-05-01', 23465.32, 109219.22, 316709.81),
('2006-06-01', 23469.08, 112342.36, 322756.35),
('2006-07-01', 23752.59, 112653.04, 324010.76),
('2006-08-01', 24185.36, 114845.67, 327885.67),
('2006-09-01', 25687.38, 116814.1, 331865.36),
('2006-10-01', 24964.16, 118359.96, 332747.17),
('2006-11-01', 25527.25, 121644.95, 337504.15),
('2006-12-01', 27072.62, 126028.05, 345577.91),
('2007-01-01', 27949.13, 128484.06, 351498.77),
('2007-02-01', 30627.93, 126258.08, 358659.25),
('2007-03-01', 27387.95, 127881.31, 364104.66),
('2007-04-01', 27813.88, 127678.33, 367326.45),
('2007-05-01', 26727.97, 130275.8, 369718.15),
('2007-06-01', 26881.09, 135847.4, 377832.15),
('2007-07-01', 27326.26, 136237.43, 383884.88),
('2007-08-01', 27822.39, 140993.21, 387205.04),
('2007-09-01', 29030.58, 142591.57, 393098.91),
('2007-10-01', 28317.78, 144649.33, 394204.17),
('2007-11-01', 28987.92, 148009.82, 399757.91),
('2007-12-01', 30334.32, 152519.17, 403401.3),
('2008-01-01', 36673.15, 154872.59, 417846.17),
('2008-02-01', 32454.47, 150177.88, 421037.84),
('2008-03-01', 30433.07, 150867.47, 423054.53),
('2008-04-01', 30789.61, 151694.91, 429313.72),
('2008-05-01', 30169.3, 153344.75, 436221.6),
('2008-06-01', 30181.32, 154820.15, 443141.02),
('2008-07-01', 30687.19, 154992.44, 446362.17),
('2008-08-01', 30851.62, 156889.92, 448846.68),
('2008-09-01', 31724.88, 155748.97, 452898.71),
('2008-10-01', 31317.84, 157194.36, 453133.32),
('2008-11-01', 31607.36, 157826.63, 458644.66),
('2008-12-01', 34218.96, 166217.13, 475166.6),
('2009-01-01', 41082.37, 165214.34, 496135.31),
('2009-02-01', 35141.64, 166149.6, 506708.07),
('2009-03-01', 33746.42, 176541.13, 530626.71),
('2009-04-01', 34257.27, 178213.57, 540481.21),
('2009-05-01', 33559.52, 182025.58, 548263.51),
('2009-06-01', 33640.98, 193138.15, 568916.2),
('2009-07-01', 34239.3, 195889.27, 573102.85),
('2009-08-01', 34406.62, 200394.83, 576698.95),
('2009-09-01', 36787.89, 201708.14, 585405.34),
('2009-10-01', 35730.23, 207545.74, 586643.29),
('2009-11-01', 36343.86, 212493.2, 594604.72),
('2009-12-01', 38245.97, 220004.47, 606223.55),
('2010-01-01', 40758.58, 229588.98, 625609.29),
('2010-02-01', 42865.79, 224286.95, 636072.26),
('2010-03-01', 39080.58, 229397.93, 649947.46),
('2010-04-01', 39657.54, 233909.76, 656561.22),
('2010-05-01', 38652.97, 236497.88, 663351.37),
('2010-06-01', 38904.85, 240580, 673921.72),
('2010-07-01', 39543.16, 240664.07, 674051.48),
('2010-08-01', 39922.76, 244334.55, 687502.15),
('2010-09-01', 41854.41, 243821.9, 696471.5),
('2010-10-01', 41646.21, 253313.17, 699776.74),
('2010-11-01', 42252.16, 259420.32, 710339.03),
('2010-12-01', 44628.17, 266621.54, 725851.79),
('2011-01-01', 58063.94, 261765.01, 733884.83),
('2011-02-01', 47270.24, 259200.5, 736130.86),
('2011-03-01', 44845.22, 266255.48, 758130.88),
('2011-04-01', 45489.03, 266766.91, 757384.56),
('2011-05-01', 44602.83, 269289.63, 763409.22),
('2011-06-01', 44477.8, 274662.57, 780820.85),
('2011-07-01', 45183.1, 270545.65, 772923.65),
('2011-08-01', 45775.29, 273393.77, 780852.3),
('2011-09-01', 47145.29, 267193.16, 787406.2),
('2011-10-01', 46579.39, 276552.67, 816829.25),
('2011-11-01', 47317.26, 281416.37, 825493.94),
('2011-12-01', 50748.46, 289847.7, 851590.9),
('2012-01-01', 59820.72, 270010.4, 855898.89),
('2012-02-01', 51448.78, 270312.11, 867171.42),
('2012-03-01', 49595.74, 277998.11, 895565.5),
('2012-04-01', 50199.32, 274983.82, 889604.04),
('2012-05-01', 49039.72, 278656.31, 900048.77),
('2012-06-01', 49284.64, 287526.17, 924991.2),
('2012-07-01', 49705.85, 283090.68, 919072.4),
('2012-08-01', 50235.06, 285739.27, 924894.59),
('2012-09-01', 53433.49, 286788.21, 943688.75),
('2012-10-01', 51467.71, 293309.78, 936404.28),
('2012-11-01', 52392.12, 296883, 944832.4),
('2012-12-01', 54659.77, 308664.23, 974148.8),
('2013-01-01', 62449.63, 311228.55, 992129.25),
('2013-02-01', 60313.65, 296103.24, 998600.83),
('2013-03-01', 55460.52, 310898.29, 1035858.37),
('2013-04-01', 55607.15, 307648.42, 1032551.9),
('2013-05-01', 54431.39, 310204.48, 1042169.16),
('2013-06-01', 54063.91, 313499.82, 1054403.69),
('2013-07-01', 54412.78, 310596.46, 1052212.34),
('2013-08-01', 54925.35, 314085.91, 1061256.43),
('2013-09-01', 56492.53, 312330.34, 1077379.16),
('2013-10-01', 55595.72, 319509.38, 1070242.17),
('2013-11-01', 56441.27, 324821.92, 1079257.06),
('2013-12-01', 58574.44, 337291.05, 1106524.98),
('2014-01-01', 76488.6, 314900.55, 1123521.21),
('2014-02-01', 62320.95, 316625.11, 1131760.83),
('2014-03-01', 58329.3, 327683.74, 1160687.38),
('2014-04-01', 58615.54, 324482.52, 1168812.67),
('2014-05-01', 58051.11, 327839.56, 1182293.96),
('2014-06-01', 56951.05, 341487.45, 1209587.2),
('2014-07-01', 57346.5, 331347.32, 1194249.24),
('2014-08-01', 57997.61, 332023.23, 1197499.08),
('2014-09-01', 58844.99, 327220.21, 1202051.41),
('2014-10-01', 57691.64, 329617.73, 1199236.31),
('2014-11-01', 58438.53, 335114.13, 1208605.95),
('2014-12-01', 60259.53, 348056.41, 1228374.81),
('2015-01-01', 63040.51, 348109.5, 1242710.22),
('2015-02-01', 72896.19, 334439.22, 1257380.48),
('2015-03-01', 61949.81, 337210.52, 1275332.78),
('2015-04-01', 60772.46, 336388.24, 1280779.14),
('2015-05-01', 59075.97, 343085.86, 1307357.63),
('2015-06-01', 58604.26, 356082.86, 1333375.36),
('2015-07-01', 59010.71, 353122.19, 1353210.92),
('2015-08-01', 59061.79, 362793.73, 1356907.98),
('2015-09-01', 61022.97, 364416.9, 1359824.06),
('2015-10-01', 59900.48, 375806.45, 1361020.7),
('2015-11-01', 60328.24, 387618.32, 1373956.01),
('2015-12-01', 63216.58, 400953.44, 1392278.11),
('2016-01-01', 72526.51, 412685.64, 1416319.55),
('2016-02-01', 69421.5, 392504.7, 1424618.68),
('2016-03-01', 64651.21, 411581.31, 1446198.03),
('2016-04-01', 64403.17, 413504.84, 1445209.59),
('2016-05-01', 62780.71, 424250.7, 1461695.11),
('2016-06-01', 62818.89, 443643.7, 1490491.83),
('2016-07-01', 63276.01, 442934.43, 1491558.72),
('2016-08-01', 63454.7, 454543.6, 1510982.91),
('2016-09-01', 65068.62, 454340.25, 1516360.5),
('2016-10-01', 64214.93, 465446.65, 1519485.4),
('2016-11-01', 64903.5, 475405.54, 1530432.06),
('2016-12-01', 68303.87, 486557.24, 1550066.67),
('2017-01-01', 86598.61, 472526.45, 1584194.56),
('2017-02-01', 71727.69, 476527.6, 1589857),
('2017-03-01', 68605.05, 488770.09, 1607938.98),
('2017-04-01', 68392.6, 490180.42, 1603918.84),
('2017-05-01', 67333.21, 496389.78, 1609740.77),
('2017-06-01', 66977.68, 510228.17, 1639497.05),
('2017-07-01', 67129.04, 510484.58, 1636341.11),
('2017-08-01', 67550.99, 518113.93, 1652947.3),
('2017-09-01', 69748.54, 517863.04, 1663666.05),
('2017-10-01', 68230.69, 525977.19, 1662449.96),
('2017-11-01', 68623.16, 535565.05, 1679156.64),
('2017-12-01', 70645.6, 543790.15, 1690235.31),
('2018-01-01', 74636.29, 543247.13, 1720814.46),
('2018-02-01', 81424.24, 517035.99, 1729070.12),
('2018-03-01', 72692.63, 523540.07, 1739859.48),
('2018-04-01', 71476.46, 525447.77, 1737683.73),
('2018-05-01', 69774.81, 526276.72, 1743063.79),
('2018-06-01', 69589.33, 543944.71, 1770178.37),
('2018-07-01', 69530.59, 536624.29, 1776196.11),
('2018-08-01', 69775.39, 538324.64, 1788670.43),
('2018-09-01', 71254.26, 538574.08, 1801665.58),
('2018-10-01', 70106.62, 540128.37, 1795561.6),
('2018-11-01', 70563.3, 543498.66, 1813175.07),
('2018-12-01', 73208.4, 551685.91, 1826744.22),
('2019-01-01', 87470.62, 545638.46, 1865935.33),
('2019-02-01', 79484.72, 527190.48, 1867427.45),
('2019-03-01', 74941.58, 547575.54, 1889412.14),
('2019-04-01', 73965.76, 540614.6, 1884670.33),
('2019-05-01', 72798.46, 544355.64, 1891153.7),
('2019-06-01', 72580.96, 567696.18, 1921360.19),
('2019-07-01', 72689.25, 553043.11, 1919410.82),
('2019-08-01', 73152.62, 556798.09, 1935492.43),
('2019-09-01', 74129.75, 557137.95, 1952250.49),
('2019-10-01', 73395.4, 558143.92, 1945600.55),
('2019-11-01', 73973.82, 562486.52, 1961429.56),
('2019-12-01', 77189.47, 576009.15, 1986488.82),
('2020-01-01', 93249.16, 545531.79, 2023066.49),
('2020-02-01', 88187.05, 552700.73, 2030830.42),
('2020-03-01', 83022.21, 575050.29, 2080923.41),
('2020-04-01', 81485.21, 570150.48, 2093533.83),
('2020-05-01', 79706.83, 581111.06, 2100183.74),
('2020-06-01', 79459.41, 604317.97, 2134948.66),
('2020-07-01', 79867.21, 591192.64, 2125458.46),
('2020-08-01', 80000, 601300, 2136800),
('2020-09-01', 82400, 602300, 2164100),
('2020-10-01', 81000, 609200, 2149700),
('2020-11-01', 81600, 618600, 2172000),
('2020-12-01', 84300, 625600, 2186800),
('2021-01-01', 89600, 625600, 2213000),
('2021-02-01', 91900, 593500, 2236000),
('2021-03-01', 86500, 616100, 2276500),
('2021-04-01', 85800, 605400, 2262100);